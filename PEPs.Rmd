---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

################################          Normality tests      #######################################

#These tests are performed with raw datas

```{r}
megnorm <- read.delim("C:/.../meg.txt")
milnorm <- read.delim("C:/.../mil.txt")
saxnorm <- read.delim("C:/.../sax.txt")
taonorm <- read.delim("C:/.../tao.txt")
petnorm <- read.delim("C:/.../pet.txt")

#Shapiro-Wilks
set.seed(1)
capture.output(shapiro.test(megnorm$crc), file = "shap.megnorm.crc.txt")
capture.output(shapiro.test(megnorm$nivesq), file = "shap.megnorm.nivesq.txt")
capture.output(shapiro.test(milnorm$crc), file = "shap.milnorm.crc.txt")
capture.output(shapiro.test(milnorm$nivesq), file = "shap.milnorm.nivesq.txt")
capture.output(shapiro.test(saxnorm$crc), file = "shap.saxnorm.crc.txt")
capture.output(shapiro.test(saxnorm$nivesq), file = "shap.saxnorm.nivesq.txt")
capture.output(shapiro.test(taonorm$crc), file = "shap.taonorm.crc.txt")
capture.output(shapiro.test(taonorm$nivesq), file = "shap.taonorm.nivesq.txt")
capture.output(shapiro.test(petnorm$crc), file = "shap.petnorm.crc.txt")
capture.output(shapiro.test(petnorm$nexcesq), file = "shap.petnorm.nexcesq.txt")

#Distribution Graphics
set.seed(1)
ggplot(subset(petnorm), aes(crc)) + 
  geom_density(aes(x = crc), kernel = "gaussian", color = "#284D00") +
  labs(x = "crc petropolitana") +
  theme_bw()

set.seed(1)
ggplot(subset(petnorm), aes(nexcesq)) + 
  geom_histogram(aes(x = nexcesq), color = "#284D00", binwidth = 1, center = 0) +
  labs(x = "nexcesq petropolitana") +
  theme_bw()
  
set.seed(1)
ggplot(subset(megnorm), aes(crc)) + 
  geom_density(aes(x = crc), kernel = "gaussian", color = "#284D00") +
  labs(x = "crc megatympanum") +
  theme_bw()

set.seed(1)
ggplot(subset(megnorm), aes(nivesq)) + 
  geom_histogram(aes(x = nivesq), color = "#284D00", binwidth = 1, center = 0) +
  labs(x = "nivesq megatympanum") +
  theme_bw()
  
set.seed(1)
ggplot(subset(milnorm), aes(crc)) + 
  geom_density(aes(x = crc), kernel = "gaussian", color = "#284D00") +
  labs(x = "crc miliaris") +
  theme_bw()

set.seed(1)
ggplot(subset(milnorm), aes(nivesq)) + 
  geom_histogram(aes(x = nivesq), color = "#284D00", binwidth = 1, center = 0) +
  labs(x = "nivesq miliaris") +
  theme_bw()

set.seed(1)
ggplot(subset(saxnorm), aes(crc)) + 
  geom_density(aes(x = crc), kernel = "gaussian", color = "#284D00") +
  labs(x = "crc saxatilis") +
  theme_bw()

set.seed(1)
ggplot(subset(saxnorm), aes(nivesq)) + 
  geom_histogram(aes(x = nivesq), color = "#284D00", binwidth = 1, center = 0) +
  labs(x = "nivesq saxatilis") +
  theme_bw()

set.seed(1)
ggplot(subset(taonorm), aes(crc)) + 
  geom_density(aes(x = crc), kernel = "gaussian", color = "#284D00") +
  labs(x = "crc taophora") +
  theme_bw()

set.seed(1)
ggplot(subset(taonorm), aes(nivesq)) + 
  geom_histogram(aes(x = nivesq), color = "#284D00", binwidth = 1, center = 0) +
  labs(x = "nivesq taophora") +
  theme_bw()
  
```

############################################### Violin Plots #####################################################

```{r}

#Total sample of PEPs by species, by part of the hand

peps <- 
  read.delim("C:/.../thoropa380_spp_peps.txt")

set.seed(1)
ggplot(data = peps, aes(x = spp, y = nexcesq)) + 
  geom_violin(trim = TRUE, fill = "cadetblue4", color = "#284D00") +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  scale_y_continuous(limits = c(0, 50)) +
  labs(x = "species", y = "nexcesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))
  
capture.output(as.data.frame(kruskal_test(data = peps, formula = nexcesq ~ spp)), file = "kruskalwallis-nexcesq-peps.txt")
capture.output(as.data.frame(dunn_test(data = peps, formula = nexcesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-nexcesq-peps.txt") 

set.seed(1)
ggplot(data = peps, aes(x = spp, y = ntubesq)) + 
  geom_violin(trim = TRUE, fill = "cadetblue4", color = "#284D00") +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  scale_y_continuous(limits = c(0, 50)) +
  labs(x = "species", y = "ntubesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))
  
capture.output(as.data.frame(kruskal_test(data = peps, formula = ntubesq ~ spp)), file = "kruskalwallis-ntubesq-peps.txt")
capture.output(as.data.frame(dunn_test(data = peps, formula = ntubesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-ntubesq-peps.txt")

set.seed(1)
ggplot(data = peps, aes(x = spp, y = niiesq)) + 
  geom_violin(trim = TRUE, fill = "cadetblue4", color = "#284D00") +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  scale_y_continuous(limits = c(0, 50)) +
  labs(x = "species", y = "niiesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))
  
capture.output(as.data.frame(kruskal_test(data = peps, formula = niiesq ~ spp)), file = "kruskalwallis-niiesq-peps.txt")
capture.output(as.data.frame(dunn_test(data = peps, formula = niiesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-niiesq-peps.txt")


set.seed(1)
ggplot(data = peps, aes(x = spp, y = niiiesq)) + 
  geom_violin(trim = TRUE, fill = "cadetblue4", color = "#284D00") +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  scale_y_continuous(limits = c(0, 50)) +
  labs(x = "species", y = "niiiesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))
  
capture.output(as.data.frame(kruskal_test(data = peps, formula = niiiesq ~ spp)), file = "kruskalwallis-niiiesq-peps.txt")
capture.output(as.data.frame(dunn_test(data = peps, formula = niiiesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-niiiesq-peps.txt")


set.seed(1)
ggplot(data = peps, aes(x = spp, y = nivesq)) + 
  geom_violin(trim = TRUE, fill = "cadetblue4", color = "#284D00") +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  scale_y_continuous(limits = c(0, 50)) +
  labs(x = "species", y = "nivesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))
  
capture.output(as.data.frame(kruskal_test(data = peps, formula = nivesq ~ spp)), file = "kruskalwallis-nivesq-peps.txt")
capture.output(as.data.frame(dunn_test(data = peps, formula = nivesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-nivesq-peps.txt")

#removing the biggest limiting factor of sample size (the PEPs of MPA-II)

pepsparcial <- 
  read.delim("C:/.../thoropa502_spp_pepsparcial.txt")

set.seed(1)
ggplot(data = pepsparcial, aes(x = spp, y = ntubesq)) + 
  geom_violin(trim = TRUE, fill = "cadetblue4", color = "#284D00") +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  scale_y_continuous(limits = c(0, 50)) +
  labs(x = "species", y = "ntubesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))
  
capture.output(as.data.frame(kruskal_test(data = pepsparcial, formula = ntubesq ~ spp)), file = "kruskalwallis-ntubesq-pepsparcial.txt")
capture.output(as.data.frame(dunn_test(data = pepsparcial, formula = ntubesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-ntubesq-pepsparcial.txt")


set.seed(1)
ggplot(data = pepsparcial, aes(x = spp, y = niiesq)) + 
  geom_violin(trim = TRUE, fill = "cadetblue4", color = "#284D00") +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  scale_y_continuous(limits = c(0, 50)) +
  labs(x = "species", y = "niiesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))
  
capture.output(as.data.frame(kruskal_test(data = pepsparcial, formula = niiesq ~ spp)), file = "kruskalwallis-niiesq-pepsparcial.txt")
capture.output(as.data.frame(dunn_test(data = pepsparcial, formula = niiesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-niiesq-pepsparcial.txt")

set.seed(1)
ggplot(data = pepsparcial, aes(x = spp, y = niiiesq)) + 
  geom_violin(trim = TRUE, fill = "cadetblue4", color = "#284D00") +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  scale_y_continuous(limits = c(0, 50)) +
  labs(x = "species", y = "niiiesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))

capture.output(as.data.frame(kruskal_test(data = pepsparcial, formula = niiiesq ~ spp)), file = "kruskalwallis-niiiesq-pepsparcial.txt")
capture.output(as.data.frame(dunn_test(data = pepsparcial, formula = niiiesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-niiiesq-pepsparcial.txt")

set.seed(1)
ggplot(data = pepsparcial, aes(x = spp, y = nivesq)) + 
  geom_violin(trim = TRUE, fill = "cadetblue4", color = "#284D00") +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  scale_y_continuous(limits = c(0, 50)) +
  labs(x = "species", y = "nivesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))

capture.output(as.data.frame(kruskal_test(data = pepsparcial, formula = nivesq ~ spp)), file = "kruskalwallis-nivesq-pepsparcial.txt")
capture.output(as.data.frame(dunn_test(data = pepsparcial, formula = nivesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-nivesq-pepsparcial.txt")
```


################################          Comparisons by species        #######################################

```{r}
#MPA-II by species
nexcesqspp <- read.delim("C:/.../grmil216_spp_nexcesq.txt")

set.seed(1)
ggplot(data = nexcesqspp, aes(x = spp, y = nexcesq, fill = spp)) + 
  geom_violin(trim = TRUE) +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  labs(x = "species", y = "nexcesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))

capture.output(as.data.frame(kruskal_test(data = nexcesqspp, formula = nexcesq ~ spp)), file = "kruskalwallis-nexcesqspp-spp.txt")
capture.output(as.data.frame(dunn_test(data = nexcesqspp, formula = nexcesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-nexcesqspp-spp.txt")

#IMT-II by species
ntubesqspp <- read.delim("C:/...grmil531_spp_ntubesq.txt")

set.seed(1)
ggplot(data = ntubesqspp, aes(x = spp, y = ntubesq, fill = spp)) + 
  geom_violin(trim = TRUE) +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  labs(x = "species", y = "ntubesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))
  
capture.output(as.data.frame(kruskal_test(data = ntubesqspp, formula = ntubesq ~ spp)), file = "kruskalwallis-ntubesqspp-spp.txt")
capture.output(as.data.frame(dunn_test(data = ntubesqspp, formula = ntubesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-ntubesqspp-spp.txt")

#Finger II by species
niiesqspp <- read.delim("C:/.../grmil532_spp_niiesq.txt")

set.seed(1)
ggplot(data = niiesqspp, aes(x = spp, y = niiesq, fill = spp)) + 
  geom_violin(trim = TRUE) +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  labs(x = "species", y = "niiesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))

capture.output(as.data.frame(kruskal_test(data = niiesqspp, formula = niiesq ~ spp)), file = "kruskalwallis-niiesqspp-spp.txt")
capture.output(as.data.frame(dunn_test(data = niiesqspp, formula = niiesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-niiesqspp-spp.txt")

#Finger III by species

niiiesqspp <- read.delim("C:/.../grmil600_spp_niiiesq.txt")

set.seed(1)
ggplot(data = niiiesqspp, aes(x = spp, y = niiiesq, fill = spp)) + 
  geom_violin(trim = TRUE) +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  labs(x = "species", y = "niiiesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))

capture.output(as.data.frame(kruskal_test(data = niiiesqspp, formula = niiiesq ~ spp)), file = "kruskalwallis-niiiesqspp-spp.txt")
capture.output(as.data.frame(dunn_test(data = niiiesqspp, formula = niiiesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-niiiesqspp-spp.txt")

#Finger IV by species

nivesqspp <- read.delim("C:/.../grmil616_spp_nivesq.txt")

set.seed(1)
ggplot(data = nivesqspp, aes(x = spp, y = nivesq, fill = spp)) + 
  geom_violin(trim = TRUE) +
  geom_jitter(height = 0, width = 0.1, size = 1.75, color = "black") +
  labs(x = "species", y = "nivesq") +
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic"))

capture.output(as.data.frame(kruskal_test(data = nivesqspp, formula = nivesq ~ spp)), file = "kruskalwallis-nivesqspp-spp.txt")
capture.output(as.data.frame(dunn_test(data = nivesqspp, formula = nivesq ~ spp, p.adjust.method = "bonferroni", detailed = TRUE)), file = "dunn-nivesqspp-spp.txt")
```

################################          Relationship between PEPs and SVL        #####################################

```{r}
##Linear Regressions between N of PEPs and SVL in each part of the hand, by species
thoropapepscrc <- read.delim("C:/.../thoropa1024_spp_pepsXcrc.txt")

thoropapepscrc$crc <- as.numeric(thoropapepscrc$crc)
thoropapepscrc$nexcesq <- as.numeric(thoropapepscrc$nexcesq)
thoropapepscrc$ntubesq <- as.numeric(thoropapepscrc$ntubesq)
thoropapepscrc$niiesq <- as.numeric(thoropapepscrc$niiesq)
thoropapepscrc$niiiesq <- as.numeric(thoropapepscrc$niiiesq)
thoropapepscrc$nivesq <- as.numeric(thoropapepscrc$nivesq)

#Graphic
ggplot(thoropapepscrc, x = crc) + 
  geom_point(aes(x = crc, y = nexcesq), fill = "red", color = "black", shape = 21, size = 1.5) +
  geom_smooth(aes(x = crc, y = nexcesq), method = "lm", se = FALSE, color = "red") + 
  stat_regline_equation(aes(x = crc, y = nexcesq), data = NULL, color = "red", label.x.npc = 0.6, label.y.npc = 0.2) +
  geom_point(aes(x = crc, y = ntubesq), fill = "blue", color = "black", shape = 21, size = 1.5) +
  geom_smooth(aes(x = crc, y = ntubesq), method = "lm", se = FALSE, color = "blue") + 
  stat_regline_equation(aes(x = crc, y = ntubesq), data = NULL, color = "blue", label.x.npc = 0.6, label.y.npc = 0.2) +
  geom_point(aes(x = crc, y = niiesq), fill = "green", color = "black", shape = 21, size = 1.5) +
  geom_smooth(aes(x = crc, y = niiesq), method = "lm", se = FALSE, color = "green") + 
  stat_regline_equation(aes(x = crc, y = niiesq), data = NULL, color = "green", label.x.npc = 0.6, label.y.npc = 0.2) +
  geom_point(aes(x = crc, y = niiiesq), fill = "pink", color = "black", shape = 21, size = 1.5) +
  geom_smooth(aes(x = crc, y = niiiesq), method = "lm", se = FALSE, color = "pink") + 
  stat_regline_equation(aes(x = crc, y = niiiesq), data = NULL, color = "pink", label.x.npc = 0.6, label.y.npc = 0.2) +
  geom_point(aes(x = crc, y = nivesq), fill = "black", color = "black", shape = 21, size = 1.5) +
  geom_smooth(aes(x = crc, y = nivesq), method = "lm", se = FALSE, color = "black") + 
  stat_regline_equation(aes(x = crc, y = nivesq), data = NULL, color = "black", label.x.npc = 0.6, label.y.npc = 0.2) +
  facet_wrap(~ spp, scales = "free") + 
  labs(x = "CRC (mm)", y = "peps") +
  theme_bw() +
  theme(strip.background = element_rect(fill ="white"), strip.text = element_text(face = "bold.italic", size = 13))
  
#Regression summary
capture.output(summary(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana")), file = "lm-crcXnexcesq-petropolitana.txt")
capture.output(summary(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum")), file = "lm-crcXnexcesq-megatympanum.txt")
capture.output(summary(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris")), file = "lm-crcXnexcesq-miliaris.txt")
capture.output(summary(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis")), file = "lm-crcXnexcesq-saxatilis.txt")
capture.output(summary(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora")), file = "lm-crcXnexcesq-taophora.txt")
capture.output(summary(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana")), file = "lm-crcXntubesq-petropolitana.txt")
capture.output(summary(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum")), file = "lm-crcXntubesq-petropolitana.txt")
capture.output(summary(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris")), file = "lm-crcXntubesq-miliaris.txt")
capture.output(summary(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis")), file = "lm-crcXntubesq-saxatilis.txt")
capture.output(summary(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora")), file = "lm-crcXntubesq-taophora.txt")
capture.output(summary(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana")), file = "lm-crcXniiesq-petropolitana.txt")
capture.output(summary(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum")), file = "lm-crcXniiesq-megatympanum.txt")
capture.output(summary(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris")), file = "lm-crcXniiesq-miliaris.txt")
capture.output(summary(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis")), file = "lm-crcXniiesq-saxatilis.txt")
capture.output(summary(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora")), file = "lm-crcXniiesq-taophora.txt")
capture.output(summary(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana")), file = "lm-crcXniiiesq-petropolitana.txt")
capture.output(summary(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum")), file = "lm-crcXniiiesq-megatympanum.txt")
capture.output(summary(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris")), file = "lm-crcXniiiesq-miliaris.txt")
capture.output(summary(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis")), file = "lm-crcXniiiesq-saxatilis.txt")
capture.output(summary(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora")), file = "lm-crcXniiiesq-taophora.txt")
capture.output(summary(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana")), file = "lm-crcXnivesq-petropolitana.txt")
capture.output(summary(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum")), file = "lm-crcXnivesq-megatympanum.txt")
capture.output(summary(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris")), file = "lm-crcXnivesq-miliaris.txt")
capture.output(summary(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis")), file = "lm-crcXnivesq-saxatilis.txt")
capture.output(summary(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora")), file = "lm-crcXnivesq-taophora.txt")


#Regression Diagnostics
png("diagnostico-crcXnexcesq-petropolitana.png")
par(mfrow=c(2,2))
plot(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana"), main="CRC x Nexc-esq de Thoropa petropolitana")
abline(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana"), col="red")
dev.off()

png("diagnostico-crcXnexcesq-megatympanum.png")
par(mfrow=c(2,2))
plot(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum"), main="CRC x Nexc-esq de Thoropa megatympanum")
abline(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum"), col="red")
dev.off()

png("diagnostico-crcXnexcesq-miliaris.png")
par(mfrow=c(2,2))
plot(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris"), main="CRC x Nexc-esq de Thoropa miliaris")
abline(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris"), col="red")
dev.off()

png("diagnostico-crcXnexcesq-saxatilis.png")
par(mfrow=c(2,2))
plot(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis"), main="CRC x Nexc-esq de Thoropa saxatilis")
abline(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis"), col="red")
dev.off()

png("diagnostico-crcXnexcesq-taophora.png")
par(mfrow=c(2,2))
plot(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora"), main="CRC x Nexc-esq de Thoropa taophora")
abline(lm(formula = nexcesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora"), col="red")
dev.off()

png("diagnostico-crcXntubesq-petropolitana.png")
par(mfrow=c(2,2))
plot(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana"), main="CRC x Ntub-esq de Thoropa petropolitana")
abline(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana"), col="red")
dev.off()

png("diagnostico-crcXntubesq-megatympanum.png")
par(mfrow=c(2,2))
plot(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum"), main="CRC x Ntub-esq de Thoropa megatympanum")
abline(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum"), col="red")
dev.off()

png("diagnostico-crcXntubesq-miliaris.png")
par(mfrow=c(2,2))
plot(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris"), main="CRC x Ntub-esq de Thoropa miliaris")
abline(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris"), col="red")
dev.off()

png("diagnostico-crcXntubesq-saxatilis.png")
par(mfrow=c(2,2))
plot(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis"), main="CRC x Ntub-esq de Thoropa saxatilis")
abline(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis"), col="red")
dev.off()

png("diagnostico-crcXntubesq-taophora.png")
par(mfrow=c(2,2))
plot(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora"), main="CRC x Ntub-esq de Thoropa taophora")
abline(lm(formula = ntubesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora"), col="red")
dev.off()

png("diagnostico-crcXniiesq-petropolitana.png")
par(mfrow=c(2,2))
plot(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana"), main="CRC x Nii-esq de Thoropa petropolitana")
abline(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana"), col="red")
dev.off()

png("diagnostico-crcXniiesq-megatympanum.png")
par(mfrow=c(2,2))
plot(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum"), main="CRC x Nii-esq de Thoropa megatympanum")
abline(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum"), col="red")
dev.off()

png("diagnostico-crcXniiesq-miliaris.png")
par(mfrow=c(2,2))
plot(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris"), main="CRC x Nii-esq de Thoropa miliaris")
abline(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris"), col="red")
dev.off()

png("diagnostico-crcXniiesq-saxatilis.png")
par(mfrow=c(2,2))
plot(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis"), main="CRC x Nii-esq de Thoropa saxatilis")
abline(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis"), col="red")
dev.off()

png("diagnostico-crcXniiesq-taophora.png")
par(mfrow=c(2,2))
plot(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora"), main="CRC x Nii-esq de Thoropa taophora")
abline(lm(formula = niiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora"), col="red")
dev.off()

png("diagnostico-crcXniiiesq-petropolitana.png")
par(mfrow=c(2,2))
plot(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana"), main="CRC x Niii-esq de Thoropa petropolitana")
abline(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana"), col="red")
dev.off()

png("diagnostico-crcXniiiesq-megatympanum.png")
par(mfrow=c(2,2))
plot(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum"), main="CRC x Niii-esq de Thoropa megatympanum")
abline(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum"), col="red")
dev.off()

png("diagnostico-crcXniiiesq-miliaris.png")
par(mfrow=c(2,2))
plot(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris"), main="CRC x Niii-esq de Thoropa miliaris")
abline(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris"), col="red")
dev.off()

png("diagnostico-crcXniiiesq-saxatilis.png")
par(mfrow=c(2,2))
plot(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis"), main="CRC x Niii-esq de Thoropa saxatilis")
abline(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis"), col="red")
dev.off()

png("diagnostico-crcXniiiesq-taophora.png")
par(mfrow=c(2,2))
plot(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora"), main="CRC x Niii-esq de Thoropa taophora")
abline(lm(formula = niiiesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora"), col="red")
dev.off()

png("diagnostico-crcXnivesq-petropolitana.png")
par(mfrow=c(2,2))
plot(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana"), main="CRC x Niv-esq de Thoropa petropolitana")
abline(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa petropolitana"), col="red")
dev.off()

png("diagnostico-crcXnivesq-megatympanum.png")
par(mfrow=c(2,2))
plot(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum"), main="CRC x Niv-esq de Thoropa megatympanum")
abline(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa megatympanum"), col="red")
dev.off()

png("diagnostico-crcXnivesq-miliaris.png")
par(mfrow=c(2,2))
plot(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris"), main="CRC x Niv-esq de Thoropa miliaris")
abline(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa miliaris"), col="red")
dev.off()

png("diagnostico-crcXnivesq-saxatilis.png")
par(mfrow=c(2,2))
plot(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis"), main="CRC x Niv-esq de Thoropa saxatilis")
abline(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa saxatilis"), col="red")
dev.off()

png("diagnostico-crcXnivesq-taophora.png")
par(mfrow=c(2,2))
plot(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora"), main="CRC x Niv-esq de Thoropa taophora")
abline(lm(formula = nivesq ~ crc, data = thoropapepscrc, subset = thoropapepscrc$spp == "Thoropa taophora"), col="red")
dev.off()

```

##################################################### PEPs color and collection dates ################################

```{r}
cor <- read.delim("C:/.../anocor_623.txt")

ggplot(data = cor) + 
  geom_bar(mapping = aes(x = ano, fill = corexcesq)) +
  facet_wrap(~ spp)

mescor <- read.delim("C:/.../mescor_607.txt")

ggplot(data = mescor) + 
  geom_bar(mapping = aes(x = mes, fill = corexcesq))
```

